#하이브적용예제문제_20190125(Friday)
1번 : 최대 지연을 일으킨 비행기를 찾아내시오.
[관련 컬럼:arrdelay/ flightnum]
hive> select flightnum,max(arrdelay) as maxd
    > from airdelay                         
    > group by flightnum                    
    > order by maxd desc                    
    > limit 10; 

2번 : 가장 많이 취소된 비행일정은 몇 월에 주로 나타나는가?
[관련컬럼 : cancelled/ month]
select month,COUNT(cancelled) as cancel_count 
    > from airdelay
    > group by month
    > order by cancel_count desc
    > limit 20;
8	1982030
7	1961402
3	1928226
5	1920949
6	1900130
1	1890567
4	1866211
10	1854441
9	1844042
12	1807976
11	1754611
2	1739485

3번 : 비행일정이 주로 최소되는 원인은 무엇인가?
[관련컬럼 : cancellationcode/ cancelled]
hive> select cancellationcode,COUNT(cancelled) as cancel_code
    > from airdelay
    > group by cancellationcode
    > order by cancel_code desc
    > limit 20;

NA	22450070

4번 : 월별 비행거리가 차이가 있는지 살펴보시오?
[관련컬럼 : month/ distance]
hive> select month, SUM(distance) as flight 
    > from airdelay                        
    > group by month                       
    > order by flight desc
    > limit 20;

8	1510476581
7	1495811218
5	1439576642
6	1439218701
3	1437277380
1	1398372516
4	1393515766
10	1392719209
9	1390326669
12	1371866913
11	1321281118
2	1289546437
NULL	NULL


5번 : 년도별 취소 비행건수를 비교하시오.
[관련컬럼 : cancelled/ year]
2001	5967780
2000	5683047
1999	5527884
2002	5271359

hive> select year,COUNT(cancelled) as yearly
    > from airdelay
    > group by year
    > order by yearly desc
    > limit 10;


6번 : 비행시간(airtime)을 년, 월별로 하여 평균시간으로 나타내시오.
[관련컬럼 : year/month/airtime]

hive>select year,month,avg(airtime)
>from aid
>group by year,month
>order by year asc, month asc; 
1999	1	105.79335548641536
1999	2	104.31078931408517
1999	3	104.93756059210773
1999	4	105.01841567125054
1999	5	104.68622769959848
1999	6	104.76938593463537
1999	7	104.77202573120378
1999	8	104.85168028967188
1999	9	103.84922446590576
1999	10	103.98369855577923
1999	11	104.08840679666437
1999	12	105.40918065795583
2000	1	106.27411342174565
2000	2	105.99699926207535
2000	3	106.16374991785051
2000	4	106.76589969951576
2000	5	106.09297382183054
2000	6	106.54805197109563
2000	7	106.53943540901656
2000	8	106.19490742202714
2000	9	105.92934983519537
2000	10	106.36682628067055
2000	11	106.84344218209758
2000	12	107.8096363741191
2001	1	103.2908123376955
2001	2	104.5377309362519
2001	3	103.76404821158444
2001	4	103.22701395074496
2001	5	102.829783794706
2001	6	103.51299691302196
2001	7	103.22959116740594
2001	8	103.60227893000213
2001	9	101.84243874170487
2001	10	101.47721515214735
2001	11	102.75239183380394
2001	12	104.36197170834794
2002	1	104.48433624167808
2002	2	104.32269838576086
2002	3	106.15145201877083
2002	4	105.46360666645104
2002	5	105.37298359005246
2002	6	105.91557166934682
2002	7	105.66407029198848
2002	8	105.64865610133684
2002	9	104.85354489004123
2002	10	105.85410872657107
2002	11	106.97676909035594
2002	12	108.53495340580524

7번 : 비행시간(airtime)을 비행기별(flightnum)로 큰순서부터 나열하시오. [10개만 추출]
[관련컬럼 : flightnum/airtime]
1	2965968
197	2612043
73	2348715
199	2347589
2	2320869
65	2311578
231	2267516
343	2259869
39	2258054
14	2235920

hive> select flightnum,sum(airtime) as time
    > from airdelay
    > group by flightnum
    > order by time desc
    > limit 10;

8번 : 요일(dayofweek)별로 지연(arrdelay)시간과 비행시간(airtime)의 차이를 보시오.
[관련컬럼 : dayofweek/arrdelay/arrtime]
d.o.w    arrdelay	arrtime
3	19844656	331194017
6	11139460	302585517
1	19934308	333321945
4	28452857	330932067
7	21141652	322777155
2	16067851	331590320
5	33255733	332985483

hive> select dayofweek,SUM(arrdelay),SUM(airtime)    
    > from airdelay                               
    > group by dayofweek                          
    > limit 20;  
9번 : 매월중 어느날(DayofMonth)별로 지연(arrdelay)차이가 있
는지 살피시오.
[관련컬럼 : dayofmonth/ arrdelay]
7	5.238585244466503
29	5.562215611040608
5	5.617730667847519
8	5.709573090956314
4	5.725041210177512
30	5.7429824963693346
1	5.880076849021941
24	5.9679360975211315
25	6.148831537040233
6	6.234195228164611
27	6.4752578669259035
3	6.514274840349022
2	6.583612724773521
31	6.606454853330928
9	6.791383087402261
28	6.814059479512364
23	7.148757402439641
26	7.181985527396563
20	7.194946986990937
18	7.2575779234387205
16	7.381433089435557
15	7.411397367605984
17	7.554253500596009
10	7.626597618102974
21	7.736401199508036
11	7.790095912191619
13	7.930974785094561
19	8.239321413565094
22	8.284285756055587
12	8.351887019741783
hive> select Dayofmonth, AVG(arrdelay) as day_delay
    > from airdelay
    > group by DayofMonth 
    > order by day_delay
    > limit 31;

10번 : 출발지(Origin)와 도착지(Dest)별로 가장 빈번한 지연
(arrdelay)내용들을 비교하시오.[10개만 추출]
[관련컬럼 : origin/dest/arrdelay]
LAX	LAS	60758
LAS	LAX	59014
PHX	LAX	55639
LAX	PHX	54576
SFO	LAX	50092
LAX	SFO	49774
LAS	PHX	48324
PHX	LAS	47705
MSP	ORD	46866
ORD	MSP	46781

hive> select origin, dest, COUNT(arrdelay) as delay
    > from airdelay
    > group by origin,dest
    > order by delay desc
    > limit 10;

11번 : 출발지와 도착지별로 평균적으로 가장 비행시간이 큰 순
서대로 나열하시오.[10개만 추출]
[관련컬럼 : origin/dest/airtime]
origin	avg
EWR	1082
PHX	612
ATL	602
ORD	588
DTW	588
HNL	587
PDX	586
STL	580
LAX	558
DFW	552

hive> select dest,MAX(airtime) as max_time  
    > from airdelay                       
    > group by dest                       
    > order by max_time desc              
    > limit 10;    
dest	avg
PWM	1082
HNL	707
ATL	612
EWR	587
PHX	586
OGG	579
SFO	569
JFK	558
DTW	529
MIA	522


12번 : 연도별 요일별로 비행시간 차이가 있는지 살피시오.
[관련컬럼 : year/dayofweek/airtime]
1999	1	104.01658737597033
2000	1	105.89774717186536
2001	1	102.4804338751874
2002	1	105.08871706015708
1999	2	104.09213613456278
2000	2	105.8168839386464
2001	2	102.60305110934593
2002	2	105.27130670337607
1999	3	104.13495972744438
2000	3	105.81030912623885
2001	3	102.71648024944255
2002	3	105.0848559762082
1999	4	104.14784465944916
2000	4	105.96511205208623
2001	4	103.02035335348596
2002	4	105.18535009071766
1999	5	104.0237312814083
2000	5	105.83369325859566
2001	5	102.92705255880601
2002	5	105.09877048965079
1999	6	107.55665913029709
2000	6	108.90351963754652
2001	6	105.48954426966533
2002	6	108.45367703259647
1999	7	105.37514063382105
2000	7	107.25751842698104
2001	7	103.64424367572319
2002	7	106.56975872776215

hive> select year,dayofweek,AVG(airtime) as avg    
    > from airdelay                                
    > group by year,dayofweek
    > order by avg
    > limit 31;

